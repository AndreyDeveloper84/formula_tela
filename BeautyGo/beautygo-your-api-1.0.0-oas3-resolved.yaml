openapi: 3.0.0
info:
  title: BeautyGO API
  version: 1.0.0-oas3
servers:
- url: /
security:
- bearerAuth: []
paths:
  /auth/logout/:
    post:
      summary: Выход из системы
      description: Выход пользователя. Требуется JWT токен в заголовке Authorization.
      responses:
        "204":
          description: Успешный выход пользователя
        "401":
          description: Пользователь не авторизован
      security:
      - bearerAuth: []
  /auth/verify-phone/:
    post:
      summary: Подтверждение номера телефона
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_verifyphone_body'
        required: true
      responses:
        "200":
          description: Телефон успешно подтверждён
        "400":
          description: Неверный код или формат телефона
          content:
            application/json:
              examples:
                invalid_code:
                  summary: Неверный код подтверждения
                  value:
                    detail: Invalid confirmation code
  /auth/verify-email/:
    post:
      summary: Подтверждение email
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_verifyemail_body'
        required: true
      responses:
        "200":
          description: Email успешно подтверждён
        "400":
          description: Неверный код или email
          content:
            application/json:
              examples:
                invalid_code:
                  summary: Неверный код подтверждения
                  value:
                    detail: Invalid confirmation code
  /auth/social-login/:
    post:
      summary: Авторизация через социальные сети
      description: "Вход с использованием access_token из соцсетей (Google, VK, Apple)"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_sociallogin_body'
        required: true
      responses:
        "200":
          description: Успешная авторизация
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inline_response_200'
        "400":
          description: Ошибка авторизации через соцсеть
          content:
            application/json:
              examples:
                unsupported:
                  summary: Неподдерживаемый провайдер
                  value:
                    detail: Unsupported provider
                invalid_token:
                  summary: Неверный access_token
                  value:
                    detail: Invalid access token
  /auth/register/:
    post:
      summary: Регистрация пользователя
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_register_body'
        required: true
      responses:
        "201":
          description: Пользователь успешно зарегистрирован
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inline_response_201'
        "400":
          description: Ошибка валидации
          content:
            application/json:
              examples:
                phone_exists:
                  summary: Телефон уже зарегистрирован
                  value:
                    detail: Phone already registered
                invalid_format:
                  summary: Неверный формат телефона
                  value:
                    detail: Invalid phone format
                weak_password:
                  summary: Слишком простой пароль
                  value:
                    detail: Password too weak
                unsupported_social:
                  summary: Неподдерживаемая соцсеть
                  value:
                    detail: Unsupported social account type
  /auth/login/:
    post:
      summary: Авторизация пользователя
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_login_body'
        required: true
      responses:
        "200":
          description: Успешная авторизация
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inline_response_200'
        "400":
          description: Ошибка авторизации или валидации
          content:
            application/json:
              examples:
                missing_phone:
                  summary: Не указан номер телефона
                  value:
                    detail: "Missing required field: phone"
                missing_password:
                  summary: Не указан пароль
                  value:
                    detail: "Missing required field: password"
                invalid_format:
                  summary: Неверный формат телефона
                  value:
                    detail: Invalid phone format
                invalid_credentials:
                  summary: Неверные учетные данные
                  value:
                    detail: Invalid credentials
components:
  schemas:
    auth_register_body:
      required:
      - name
      - password
      - phone
      - role
      type: object
      properties:
        name:
          type: string
          example: Иван Иванов
        phone:
          type: string
          example: +79991234567
        password:
          type: string
          example: securepassword
        role:
          type: string
          example: client
          enum:
          - client
          - specialist
        social_accounts:
          type: array
          example:
          - google
          items:
            type: string
            enum:
            - google
            - vk
            - apple
    inline_response_201:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: Иван Иванов
        phone:
          type: string
          example: +79991234567
        role:
          type: string
          example: client
        token:
          type: string
          example: JWT_TOKEN
    inline_response_200:
      type: object
      properties:
        token:
          type: string
          example: JWT_TOKEN
        user:
          $ref: '#/components/schemas/inline_response_200_user'
    auth_login_body:
      required:
      - password
      - phone
      type: object
      properties:
        phone:
          type: string
          example: +79991234567
        password:
          type: string
          example: securepassword
    inline_response_200_user:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: Иван Иванов
        role:
          type: string
          example: client
    auth_verifyemail_body:
      required:
      - code
      - email
      type: object
      properties:
        email:
          type: string
          example: ivan@example.com
        code:
          type: string
          example: "654321"
    auth_verifyphone_body:
      required:
      - code
      - phone
      type: object
      properties:
        phone:
          type: string
          example: +79991234567
        code:
          type: string
          example: "123456"
    auth_sociallogin_body:
      required:
      - access_token
      - provider
      type: object
      properties:
        provider:
          type: string
          example: google
          enum:
          - google
          - vk
          - apple
        access_token:
          type: string
          example: ya29.A0ARrdaM...
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
